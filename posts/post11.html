<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Wiener Process Simulation - Statistics Homework XI</title>

  <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(', '\\)'], ['$', '$']] },
      options: { renderActions: { addMenu: [] } }
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

  <link rel="stylesheet" href="../css/custom.css">
</head>
<body>

  <nav class="navbar navbar-expand-lg navbar-dark bg-gradient-cyber">
    <div class="container">
      <a class="navbar-brand fw-bold" href="../index.html">
        <i class="bi bi-shield-lock-fill me-2"></i>Statistics Blog
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="../index.html">
              <i class="bi bi-house-fill me-1"></i>Home
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <header class="hero-section py-5">
   <div class="container">
     <div class="row">
       <div class="col-lg-10 mx-auto">
         <p class="text-muted mb-2">
           <i class="bi bi-calendar3 me-1"></i>December 4, 2025
         </p>
         <h1 class="display-6 gradient-text mb-2">Wiener Process Simulation via Euler-Maruyama Method</h1>
         <p class="lead mb-0">Brownian motion and generalized stochastic differential equations — Daniele De Pascali 1984462</p>
       </div>
     </div>
   </div>
  </header>

  <main class="container py-5">

    <section class="mb-5">
      <h2 class="h4 mb-3">Stochastic Differential Equations Framework</h2>
      <p>A general stochastic differential equation (SDE) describes the evolution of a random process \( X_t \) under both deterministic drift and random fluctuations [web:20]. The Euler-Maruyama method provides a discrete-time approximation by simulating increments over small time steps [web:19].</p>

      <div class="row g-4 mb-4">
        <div class="col-md-6">
          <div class="p-4 border rounded featured-post bg-light">
            <h3 class="h6 mb-3"><i class="bi bi-gear-fill me-2"></i>General SDE Form</h3>
            <p class="mb-2">The standard form is:</p>
            <p class="mb-2">\[ dX_t = \mu(t, X_t) \, dt + \sigma(t, X_t) \, dW_t \]</p>
            <ul class="mb-0">
              <li><strong>\( \mu \):</strong> Drift coefficient (deterministic)</li>
              <li><strong>\( \sigma \):</strong> Diffusion coefficient (stochastic)</li>
              <li><strong>\( W_t \):</strong> Wiener process</li>
              <li><strong>\( X_0 \):</strong> Initial condition</li>
            </ul>
          </div>
        </div>
        <div class="col-md-6">
          <div class="p-4 border rounded featured-post bg-light">
            <h3 class="h6 mb-3"><i class="bi bi-calculator-fill me-2"></i>Euler-Maruyama Discretization</h3>
            <p class="mb-2">Discrete approximation scheme:</p>
            <p class="mb-2">\[ X_{n+1} = X_n + \mu(t_n, X_n) \Delta t + \sigma(t_n, X_n) \Delta W_n \]</p>
            <ul class="mb-0">
              <li>\( \Delta t \): Time step size</li>
              <li>\( \Delta W_n \sim \mathcal{N}(0, \Delta t) \): Wiener increment</li>
              <li>\( t_n = n \Delta t \): Discrete time points</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="alert alert-info" role="alert">
        <i class="bi bi-info-circle-fill me-2"></i>
        <strong>Standard Wiener Process:</strong> Set \( \mu = 0 \) and \( \sigma = 1 \) to obtain pure Brownian motion with \( X_0 = 0 \) [web:19][web:20].
      </div>
    </section>

    <section class="mb-5">
      <h2 class="h4 mb-3">Simulation Parameters</h2>
     
      <div class="row g-3 mb-4">
        <div class="col-md-3">
          <label class="form-label fw-semibold">Final Time (T)</label>
          <input type="number" class="form-control" id="input-T" value="1.0" min="0.1" max="10" step="0.1">
        </div>
        <div class="col-md-3">
          <label class="form-label fw-semibold">Time Steps (N)</label>
          <input type="number" class="form-control" id="input-N" value="1000" min="100" max="10000" step="100">
        </div>
        <div class="col-md-3">
          <label class="form-label fw-semibold">Initial Value (X₀)</label>
          <input type="number" class="form-control" id="input-X0" value="0" min="-5" max="5" step="0.5">
        </div>
        <div class="col-md-3">
          <label class="form-label fw-semibold">Trajectories</label>
          <input type="number" class="form-control" id="input-paths" value="5" min="1" max="20">
        </div>
      </div>

      <div class="row g-3 mb-3">
        <div class="col-md-12">
          <label class="form-label fw-semibold">SDE Type</label>
          <select class="form-select" id="sde-type">
            <option value="wiener">Standard Wiener Process (μ=0, σ=1)</option>
            <option value="drift">Wiener with Drift (μ=0.5, σ=1)</option>
            <option value="gbm">Geometric Brownian Motion (μX, σX)</option>
            <option value="ou">Ornstein-Uhlenbeck (θ(μ-X), σ)</option>
          </select>
        </div>
      </div>

      <div class="row g-3 mb-3">
        <div class="col-md-12">
          <button class="btn btn-dark btn-lg" id="runSimBtn">
            <i class="bi bi-play-fill me-2"></i>Run Simulation
          </button>
          <small class="ms-3 text-muted">Generate stochastic trajectories using Euler-Maruyama method</small>
        </div>
      </div>

      <div id="param-display" class="p-3 border rounded bg-light" style="display:none;">
        <div class="row text-center">
          <div class="col-md-3">
            <div class="text-muted small">Time Horizon</div>
            <div class="fw-bold fs-5" id="display-T">—</div>
          </div>
          <div class="col-md-3">
            <div class="text-muted small">Time Steps</div>
            <div class="fw-bold fs-5" id="display-N">—</div>
          </div>
          <div class="col-md-3">
            <div class="text-muted small">Step Size (Δt)</div>
            <div class="fw-bold fs-5" id="display-dt">—</div>
          </div>
          <div class="col-md-3">
            <div class="text-muted small">SDE Model</div>
            <div class="fw-bold fs-5" id="display-model">—</div>
          </div>
        </div>
      </div>
    </section>

    <section id="step1" class="mb-5" style="display:none;">
      <h2 class="h5 mb-3"><i class="bi bi-1-circle-fill me-2"></i>Step 1: Single Trajectory Visualization</h2>
      <p>A single realization of the stochastic process showing the path evolution over time:</p>
     
      <div class="p-4 border rounded bg-light mb-3">
        <canvas id="trajectory-canvas" width="800" height="300" style="width:100%; height:auto;"></canvas>
      </div>

      <div class="row">
        <div class="col-md-6">
          <div class="p-3 border rounded">
            <h6 class="fw-semibold mb-2">Path Statistics</h6>
            <div id="path-stats"></div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="p-3 border rounded">
            <h6 class="fw-semibold mb-2">Sample Values</h6>
            <div id="sample-values" style="max-height: 200px; overflow-y: auto;"></div>
          </div>
        </div>
      </div>
    </section>

    <section id="step2" class="mb-5" style="display:none;">
      <h2 class="h5 mb-3"><i class="bi bi-2-circle-fill me-2"></i>Step 2: Multiple Trajectories</h2>
      <p>Overlay of independent sample paths demonstrating the stochastic nature of the process:</p>

      <div class="p-4 border rounded bg-light mb-3">
        <canvas id="multi-canvas" width="800" height="400" style="width:100%; height:auto;"></canvas>
      </div>

      <div class="table-responsive mb-3">
        <table class="table table-sm table-striped">
          <thead class="table-light">
            <tr>
              <th>Path #</th>
              <th>Final Value</th>
              <th>Maximum</th>
              <th>Minimum</th>
              <th>Range</th>
              <th>Std Dev</th>
            </tr>
          </thead>
          <tbody id="paths-tbody"></tbody>
        </table>
      </div>
    </section>

    <section id="step3" class="mb-5" style="display:none;">
      <h2 class="h5 mb-3"><i class="bi bi-3-circle-fill me-2"></i>Step 3: Wiener Process Properties</h2>
      <p>Verification of key Brownian motion characteristics through empirical analysis:</p>

      <div class="row g-4 mb-4">
        <div class="col-md-6">
          <div class="p-4 border rounded featured-post">
            <h6 class="fw-semibold mb-3">Normal Increments</h6>
            <p class="mb-2">For Wiener process, increments \( W_{t+s} - W_t \) should be:</p>
            <ul class="mb-0">
              <li>Normally distributed</li>
              <li>Mean = 0</li>
              <li>Variance = s</li>
              <li>Independent of past</li>
            </ul>
            <div id="increment-stats" class="mt-3 small"></div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="p-4 border rounded featured-post">
            <h6 class="fw-semibold mb-3">Quadratic Variation</h6>
            <p class="mb-2">The quadratic variation should satisfy:</p>
            <p class="mb-2">\[ [W]_T = \lim_{|\Delta t| \to 0} \sum_{i} (W_{t_{i+1}} - W_{t_i})^2 = T \]</p>
            <div id="quadratic-var" class="mt-3 small"></div>
          </div>
        </div>
      </div>

      <div class="p-3 border rounded bg-light">
        <h6 class="fw-semibold mb-2">Increment Distribution Analysis</h6>
        <div id="increment-dist"></div>
      </div>
    </section>

    <section id="step4" class="mb-5" style="display:none;">
      <h2 class="h5 mb-3"><i class="bi bi-4-circle-fill me-2"></i>Step 4: Convergence Analysis</h2>
      <p>Examining how different step sizes affect the approximation quality:</p>

      <div class="table-responsive">
        <table class="table table-bordered">
          <thead class="table-light">
            <tr>
              <th>Step Size (Δt)</th>
              <th>Number of Steps</th>
              <th>Final Value</th>
              <th>Quadratic Variation</th>
              <th>Error vs Theory</th>
            </tr>
          </thead>
          <tbody id="convergence-tbody"></tbody>
        </table>
      </div>

      <div class="p-3 border rounded mt-3" style="background-color: #e8f5e9;">
        <h6 class="fw-semibold mb-2">Strong vs Weak Convergence</h6>
        <div id="convergence-notes"></div>
      </div>
    </section>

    <section id="step5" class="mb-5" style="display:none;">
      <h2 class="h5 mb-3"><i class="bi bi-5-circle-fill me-2"></i>Step 5: Generalized SDE Models</h2>
     
      <div class="row g-4 mb-4">
        <div class="col-md-6">
          <div class="p-4 border rounded featured-post">
            <h6 class="fw-semibold mb-3">Standard Wiener Process</h6>
            <p class="mb-2">\[ dX_t = dW_t \]</p>
            <ul class="mb-0">
              <li>No drift (\( \mu = 0 \))</li>
              <li>Unit diffusion (\( \sigma = 1 \))</li>
              <li>Pure Brownian motion</li>
              <li>\( E[X_t] = X_0 \), \( \text{Var}[X_t] = t \)</li>
            </ul>
          </div>
        </div>
        <div class="col-md-6">
          <div class="p-4 border rounded featured-post">
            <h6 class="fw-semibold mb-3">Geometric Brownian Motion</h6>
            <p class="mb-2">\[ dX_t = \mu X_t \, dt + \sigma X_t \, dW_t \]</p>
            <ul class="mb-0">
              <li>Multiplicative drift and diffusion</li>
              <li>Used in stock price modeling</li>
              <li>Always positive if \( X_0 > 0 \)</li>
              <li>Log-normal distribution</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="row g-4">
        <div class="col-md-6">
          <div class="p-4 border rounded featured-post">
            <h6 class="fw-semibold mb-3">Ornstein-Uhlenbeck Process</h6>
            <p class="mb-2">\[ dX_t = \theta(\mu - X_t) \, dt + \sigma \, dW_t \]</p>
            <ul class="mb-0">
              <li>Mean-reverting process</li>
              <li>Models interest rates, velocities</li>
              <li>Stationary distribution: \( \mathcal{N}(\mu, \sigma^2/(2\theta)) \)</li>
              <li>Convergence speed: \( \theta \)</li>
            </ul>
          </div>
        </div>
        <div class="col-md-6">
          <div class="p-4 border rounded featured-post">
            <h6 class="fw-semibold mb-3">Implementation Notes</h6>
            <div id="implementation-stats"></div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <footer class="py-4">
    <div class="container">
      <p class="mb-0 text-muted">2025 Statistics Blog</p>
    </div>
  </footer>

  <script>
    function gaussianRandom() {
      let u = 0, v = 0;
      while(u === 0) u = Math.random();
      while(v === 0) v = Math.random();
      return Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
    }

    function getDriftDiffusion(sdeType, t, x) {
      switch(sdeType) {
        case 'wiener':
          return { mu: 0, sigma: 1 };
        case 'drift':
          return { mu: 0.5, sigma: 1 };
        case 'gbm':
          return { mu: 0.1 * x, sigma: 0.3 * x };
        case 'ou':
          const theta = 1.0, muOU = 0.0, sigmaOU = 0.5;
          return { mu: theta * (muOU - x), sigma: sigmaOU };
        default:
          return { mu: 0, sigma: 1 };
      }
    }

    function eulerMaruyama(T, N, X0, sdeType) {
      const dt = T / N;
      const path = new Array(N + 1);
      const times = new Array(N + 1);
      path[0] = X0;
      times[0] = 0;

      for (let i = 0; i < N; i++) {
        const t = i * dt;
        const x = path[i];
        const { mu, sigma } = getDriftDiffusion(sdeType, t, x);
        const dW = gaussianRandom() * Math.sqrt(dt);
        path[i + 1] = x + mu * dt + sigma * dW;
        times[i + 1] = (i + 1) * dt;
      }

      return { path, times, dt };
    }

    function drawTrajectory(canvasId, paths, times, colors = null, labels = null) {
      const canvas = document.getElementById(canvasId);
      const ctx = canvas.getContext('2d');
      const width = canvas.width;
      const height = canvas.height;

      ctx.clearRect(0, 0, width, height);

      if (!Array.isArray(paths[0])) {
        paths = [paths];
      }

      let allValues = [];
      paths.forEach(p => allValues = allValues.concat(p));
      const minVal = Math.min(...allValues);
      const maxVal = Math.max(...allValues);
      const maxTime = Math.max(...times);

      const padding = 40;
      const plotWidth = width - 2 * padding;
      const plotHeight = height - 2 * padding;

      // Grid
      ctx.strokeStyle = '#e0e0e0';
      ctx.lineWidth = 1;
      for (let i = 0; i <= 5; i++) {
        const y = padding + (plotHeight / 5) * i;
        ctx.beginPath();
        ctx.moveTo(padding, y);
        ctx.lineTo(width - padding, y);
        ctx.stroke();
      }

      // Axes
      ctx.strokeStyle = '#333';
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(padding, padding);
      ctx.lineTo(padding, height - padding);
      ctx.lineTo(width - padding, height - padding);
      ctx.stroke();

      // Plot paths
      const defaultColors = ['#2c5364', '#e74c3c', '#3498db', '#2ecc71', '#f39c12', '#9b59b6'];
      paths.forEach((path, idx) => {
        ctx.strokeStyle = colors ? colors[idx] : defaultColors[idx % defaultColors.length];
        ctx.lineWidth = 2;
        ctx.beginPath();

        for (let i = 0; i < path.length; i++) {
          const x = padding + (times[i] / maxTime) * plotWidth;
          const y = height - padding - ((path[i] - minVal) / (maxVal - minVal || 1)) * plotHeight;
          if (i === 0) ctx.moveTo(x, y);
          else ctx.lineTo(x, y);
        }
        ctx.stroke();
      });

      // Labels
      ctx.fillStyle = '#333';
      ctx.font = '12px sans-serif';
      ctx.fillText('0', padding - 10, height - padding + 15);
      ctx.fillText(maxTime.toFixed(1), width - padding - 10, height - padding + 15);
      ctx.fillText(minVal.toFixed(2), 5, height - padding);
      ctx.fillText(maxVal.toFixed(2), 5, padding + 5);
    }

    function runSimulation() {
      const T = parseFloat(document.getElementById('input-T').value);
      const N = parseInt(document.getElementById('input-N').value);
      const X0 = parseFloat(document.getElementById('input-X0').value);
      const numPaths = parseInt(document.getElementById('input-paths').value);
      const sdeType = document.getElementById('sde-type').value;

      const dt = T / N;
      const sdeNames = {
        'wiener': 'Wiener',
        'drift': 'Drift',
        'gbm': 'GBM',
        'ou': 'O-U'
      };

      document.getElementById('display-T').textContent = T.toFixed(2);
      document.getElementById('display-N').textContent = N;
      document.getElementById('display-dt').textContent = dt.toFixed(6);
      document.getElementById('display-model').textContent = sdeNames[sdeType] || sdeType;
      document.getElementById('param-display').style.display = 'block';

      for (let i = 1; i <= 5; i++) {
        document.getElementById('step' + i).style.display = 'none';
      }

      // Step 1: Single trajectory
      const singlePath = eulerMaruyama(T, N, X0, sdeType);
      drawTrajectory('trajectory-canvas', singlePath.path, singlePath.times);
      
      const pathStats = calculatePathStats(singlePath.path);
      document.getElementById('path-stats').innerHTML = `
        <div class="small">
          <p class="mb-1"><strong>Initial:</strong> ${singlePath.path[0].toFixed(4)}</p>
          <p class="mb-1"><strong>Final:</strong> ${singlePath.path[N].toFixed(4)}</p>
          <p class="mb-1"><strong>Maximum:</strong> ${pathStats.max.toFixed(4)}</p>
          <p class="mb-1"><strong>Minimum:</strong> ${pathStats.min.toFixed(4)}</p>
          <p class="mb-0"><strong>Mean:</strong> ${pathStats.mean.toFixed(4)}</p>
        </div>
      `;

      let samplesHtml = '<div class="small font-monospace">';
      for (let i = 0; i <= Math.min(10, N); i += Math.floor(N / 10) || 1) {
        samplesHtml += `<div>t=${singlePath.times[i].toFixed(3)}: X=${singlePath.path[i].toFixed(4)}</div>`;
      }
      samplesHtml += '</div>';
      document.getElementById('sample-values').innerHTML = samplesHtml;
      document.getElementById('step1').style.display = 'block';

      // Step 2: Multiple paths
      const allPaths = [];
      const allPathArrays = [];
      for (let i = 0; i < numPaths; i++) {
        const pathData = eulerMaruyama(T, N, X0, sdeType);
        allPaths.push(pathData);
        allPathArrays.push(pathData.path);
      }

      drawTrajectory('multi-canvas', allPathArrays, singlePath.times);

      const tbody = document.getElementById('paths-tbody');
      tbody.innerHTML = '';
      allPaths.forEach((pathData, idx) => {
        const stats = calculatePathStats(pathData.path);
        const row = tbody.insertRow();
        row.innerHTML = `
          <td class="text-center">${idx + 1}</td>
          <td class="text-center">${pathData.path[N].toFixed(4)}</td>
          <td class="text-center">${stats.max.toFixed(4)}</td>
          <td class="text-center">${stats.min.toFixed(4)}</td>
          <td class="text-center">${(stats.max - stats.min).toFixed(4)}</td>
          <td class="text-center">${stats.std.toFixed(4)}</td>
        `;
      });
      document.getElementById('step2').style.display = 'block';

      // Step 3: Wiener properties
      if (sdeType === 'wiener') {
        analyzeWienerProperties(singlePath);
      }
      document.getElementById('step3').style.display = 'block';

      // Step 4: Convergence
      analyzeConvergence(T, X0, sdeType);
      document.getElementById('step4').style.display = 'block';

      // Step 5: Model comparison
      displayModelInfo(sdeType, allPaths);
      document.getElementById('step5').style.display = 'block';

      document.getElementById('step1').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function calculatePathStats(path) {
      const n = path.length;
      const max = Math.max(...path);
      const min = Math.min(...path);
      const mean = path.reduce((a, b) => a + b, 0) / n;
      const variance = path.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / n;
      const std = Math.sqrt(variance);
      return { max, min, mean, variance, std };
    }

    function analyzeWienerProperties(pathData) {
      const { path, times, dt } = pathData;
      const increments = [];
      for (let i = 1; i < path.length; i++) {
        increments.push(path[i] - path[i-1]);
      }

      const incStats = calculatePathStats(increments);
      document.getElementById('increment-stats').innerHTML = `
        <strong>Empirical Results:</strong>
        <p class="mb-0">Mean: ${incStats.mean.toFixed(6)} (expect ≈ 0)</p>
        <p class="mb-0">Variance: ${incStats.variance.toFixed(6)} (expect ≈ ${dt.toFixed(6)})</p>
      `;

      let quadVar = 0;
      for (let i = 1; i < path.length; i++) {
        quadVar += Math.pow(path[i] - path[i-1], 2);
      }
      const T = times[times.length - 1];
      document.getElementById('quadratic-var').innerHTML = `
        <strong>Quadratic Variation:</strong>
        <p class="mb-0">Computed: ${quadVar.toFixed(4)}</p>
        <p class="mb-0">Theoretical: ${T.toFixed(4)}</p>
        <p class="mb-0">Error: ${Math.abs(quadVar - T).toFixed(4)}</p>
      `;

      let distHtml = '<div class="small">';
      distHtml += `<p><strong>Increment Statistics (n=${increments.length}):</strong></p>`;
      distHtml += `<p class="mb-0">Min: ${Math.min(...increments).toFixed(4)}</p>`;
      distHtml += `<p class="mb-0">Max: ${Math.max(...increments).toFixed(4)}</p>`;
      distHtml += `<p class="mb-0">Std Dev: ${incStats.std.toFixed(6)} (expect ≈ ${Math.sqrt(dt).toFixed(6)})</p>`;
      distHtml += '</div>';
      document.getElementById('increment-dist').innerHTML = distHtml;
    }

    function analyzeConvergence(T, X0, sdeType) {
      const stepSizes = [T/100, T/500, T/1000, T/5000, T/10000];
      const tbody = document.getElementById('convergence-tbody');
      tbody.innerHTML = '';

      stepSizes.forEach(dt => {
        const N = Math.round(T / dt);
        const pathData = eulerMaruyama(T, N, X0, sdeType);
        
        let quadVar = 0;
        for (let i = 1; i < pathData.path.length; i++) {
          quadVar += Math.pow(pathData.path[i] - pathData.path[i-1], 2);
        }

        const error = Math.abs(quadVar - T);
        const row = tbody.insertRow();
        const errorColor = error < 0.1 ? 'text-success' : (error < 0.3 ? 'text-warning' : 'text-danger');
        row.innerHTML = `
          <td class="text-center">${dt.toFixed(6)}</td>
          <td class="text-center">${N}</td>
          <td class="text-center">${pathData.path[N].toFixed(4)}</td>
          <td class="text-center">${quadVar.toFixed(4)}</td>
          <td class="text-center ${errorColor}">${error.toFixed(4)}</td>
        `;
      });

      document.getElementById('convergence-notes').innerHTML = `
        <div class="small">
          <p class="mb-2"><strong>Euler-Maruyama Convergence:</strong></p>
          <ul class="mb-0">
            <li><strong>Strong convergence:</strong> Order 0.5 in step size</li>
            <li><strong>Weak convergence:</strong> Order 1.0 in step size</li>
            <li>Smaller Δt improves accuracy but increases computation</li>
            <li>Quadratic variation error decreases as N increases</li>
          </ul>
        </div>
      `;
    }

    function displayModelInfo(sdeType, allPaths) {
      const finalValues = allPaths.map(p => p.path[p.path.length - 1]);
      const stats = calculatePathStats(finalValues);

      const descriptions = {
        'wiener': 'Standard Brownian motion with no drift and unit diffusion.',
        'drift': 'Brownian motion with constant positive drift coefficient.',
        'gbm': 'Multiplicative model commonly used in mathematical finance.',
        'ou': 'Mean-reverting process with equilibrium at μ.'
      };

      document.getElementById('implementation-stats').innerHTML = `
        <div class="small">
          <p class="mb-2"><strong>Current Model:</strong> ${descriptions[sdeType]}</p>
          <p class="mb-1"><strong>Final Value Statistics:</strong></p>
          <p class="mb-0">Mean: ${stats.mean.toFixed(4)}</p>
          <p class="mb-0">Std Dev: ${stats.std.toFixed(4)}</p>
          <p class="mb-0">Range: [${stats.min.toFixed(4)}, ${stats.max.toFixed(4)}]</p>
        </div>
      `;
    }

    document.getElementById('runSimBtn').addEventListener('click', runSimulation);
    window.addEventListener('load', () => setTimeout(runSimulation, 300));
  </script>

</body>
</html>
